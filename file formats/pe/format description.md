#pe-file #windows #executable
# Basics
Windows-specific
Used for:
- executable
- object code
- libraries

# Headers and sections

## Headers
### IMAGE_DOS_HEADER

### MS-DOS Stub Program

### IMAGE_NT_HEADERS
#### IMAGE_FILE_HEADER
- Time Date Stamp
Delphi compiler sets as 19 July 1992 // Possible YARA detection

#### IMAGE_OPTIONAL_HEADER
- IMAGE_SUBSYSTEM_WINDOWS_CUI
Console program (no gui)
- IMAGE_SUBSYSTEM_WINDOWS_GUI
Has graphical user interface

#### IMAGE_SECTION_HEADER
VirtualSize - size of executable in memory
SizeOfRawData - size of executable on a disk
```
if VirtualSize >> SizeOfRawData - file is packed

BUT it's ok for Windows executabe .data section
```


## Sections
Section names may vary depending on a compiler
### .text
Contains executable instructions
Normally - only executable section of file

### .rdata
Contains import and export tables
Contains read-only data
Import and export tables may be located in .idata and .edata respectively

### .data
Contains global data, available from any part of a program

### .rsrc
Contains external resources - images, icons, strings

### .reloc
Data from relocated libraries

# Analysis tools
- [[peview]]
- 